BetaJS.Templates.Cached=BetaJS.Templates.Cached||{},BetaJS.Templates.Cached["rich-editor-view-template"]='  <div class="rich-editor-view">    <div class="controlbox">       <div class="button" style="float: left"><div class="buttonicon icon ui-icon-power"></div></div>       <div class="button" style="float: left"><div class="buttonicon icon ui-icon-phone"></div></div>       <div class="button" style="float: left"><div class="buttonicon icon ui-icon-apple"></div></div>   </div>   <div class="editbox">   </div>  </div> ',BetaJS.Templates.Cached["simple-rich-editor-view-template"]='  <div class="simple-rich-editor-view" contenteditable="true" data-selector="inner" data-view-id="{%= supp.view_id %}">   {%= content %}  </div> ',BetaJS.Browser.Dom={traverseNext:function(a,b){return"get"in a&&(a=a.get(0)),a.firstChild&&!b?BetaJS.$(a.firstChild):a.parentNode?a.nextSibling?BetaJS.$(a.nextSibling):this.traverseNext(a.parentNode,!0):null},selectionStartNode:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectedHtml:function(){return window.getSelection?window.getSelection().toString():document.selection?document.selection.createRange().htmlText:void 0},selectionAncestor:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).commonAncestorContainer):document.selection?BetaJS.$(document.selection.createRange().parentElement()):null},selectionStart:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectionEnd:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).endContainer):document.selection?BetaJS.$(document.selection.createRange().endContainer):null},selectionNodes:function(){var a=[],b=this.selectionStart(),c=this.selectionEnd();a.push(b);for(var d=b;d.get(0)!=c.get(0);)d=this.traverseNext(d),a.push(d);return a}},BetaJS.Views.View.extend("BetaJS.Views.SimpleRichEditorView",{_templates:{"default":BetaJS.Templates.Cached["simple-rich-editor-view-template"]},constructor:function(a){this._inherited(BetaJS.Views.SimpleRichEditorView,"constructor",a),this._setOptionProperty(a,"content",""),this._selector="[data-view-id='"+this.cid()+"']",this.actions.__context=this,this.selection.__context=this,this.caret.__context=this},_events:function(){return this._inherited(BetaJS.Views.SimpleRichEditorView,"_events").concat([{"blur [data-selector='inner']":"__change","keyup [data-selector='inner']":"__change","paste [data-selector='inner']":"__change"}])},__change:function(){this.set("content",this.$("[data-selector='inner']").html())},_render:function(){this._inherited(BetaJS.Views.SimpleRichEditorView,"_render"),this._editor=this.$("[data-selector='inner']")},actions:{__context:null,hasParentElement:function(a){var b=this.__context.selection.isSelected()?this.__context.selection:this.__context.caret;return this.__context.selection.isSelected()?b.hasParentElement(a):b.hasParentElement(a)},setParentElement:function(a,b){var c=this.hasParentElement(a);if(BetaJS.Types.is_undefined(b)&&(b=!c),b!=c){var d=this.__context.selection.isSelected()?this.__context.selection:this.__context.caret;c?d.removeParentElement(a):d.addParentElement(a)}},isBold:function(){return this.hasParentElement("strong")},bold:function(a){this.setParentElement("strong",a)},isItalic:function(){return this.hasParentElement("i")},italic:function(a){this.setParentElement("i",a)}},selection:{__context:null,isSelected:function(){return""!=BetaJS.Browser.Dom.selectedHtml()},ancestor:function(){return BetaJS.Browser.Dom.selectionAncestor()},selection:function(){return BetaJS.Browser.Dom.selectionNodes()},selectionLeaves:function(){return this.selection(),BetaJS.Objs.filter(this.selection(),function(a){return 0==a.children().length})},hasParentElement:function(a){return this.ancestor().parents(this.__context._selector+" "+a).length>0?!0:BetaJS.Objs.all(this.selectionLeaves(),function(b){return b.parents(this.__context._selector+" "+a).length>0||BetaJS.Types.is_defined(b.get(0).tagName)&&b.get(0).tagName.toLowerCase()==a.toLowerCase()},this)},addParentElement:function(){},removeParentElement:function(){}},caret:{__context:null,node:function(){return BetaJS.Browser.Dom.selectionStartNode()},hasParentElement:function(a){return this.node().parents(this.__context._selector+" "+a).length>0},addParentElement:function(){},removeParentElement:function(){}}}),BetaJS.Views.ListContainerView.extend("BetaJS.Views.RichEditorView",{constructor:function(a){a=a||{},a.el="body",a.el_classes="rich-editor-view",a.alignment="vertical",this._inherited(BetaJS.Views.RichEditorView,"constructor",a),this._setOptionProperty(a,"content","")},_domain:function(){return{toolbar:{type:"ListContainerView",options:{el_classes:"toolbar"}},font_style_dropdown:{type:"ButtonView",parent:"toolbar",options:{label:"Font"},events:{click:function(){alert("Dropdown change font-style")}}},font_size_dropdown:{type:"ButtonView",parent:"toolbar",options:{label:"16"},events:{click:function(){alert("Dropdown change font-size")}}},seperator1:{type:"BetaJS.Views.View",parent:"toolbar",options:{el_classes:"seperator"}},bold_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-bold",hotkey:"ctrl+b"},events:{click:function(){alert("Bold? "+this.domain.ns.editor_view.actions.isBold()),this.domain.ns.editor_view.actions.isBold()}}},italic_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-italic",hotkey:"ctrl+i"},events:{click:function(){alert("Italic? "+this.domain.ns.editor_view.actions.isItalic())}}},underline_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-underline"},events:{click:function(){alert("Underline")}}},seperator2:{type:"BetaJS.Views.View",parent:"toolbar",options:{el_classes:"seperator"}},left_align_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-align-left"},events:{click:function(){alert("text-align: left")}}},center_align_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-align-center"},events:{click:function(){alert("text-align: center")}}},right_align_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-align-right"},events:{click:function(){alert("text-align: right")}}},justify_align_button:{type:"ButtonView",parent:"toolbar",options:{children_classes:"icon-align-justify"},events:{click:function(){alert("text-align: justify")}}},editor_view:{type:"BetaJS.Views.SimpleRichEditorView",options:function(a){return{children_classes:"textareadiv",content:a.binding("content")}}}}}});